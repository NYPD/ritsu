/* ritsu.js v0.2.0 
 * Created 2016-10-06
 * Licensed under the MIT license
 * Source code can be found here: https://github.com/NYPD/ritsu 
 */

var rules=function(){var a=function(a){return/^([A-Za-z\s\.\-])+$/.test(a.value)},b=function(a){return/(^\d{5}([\s-]?\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Z]{1}\d{1}$)/.test(a.value)},c=function(a){return/^([a-zA-Z0-9]+)$/.test(a.value)},d=function(a){return/^(\S+@\S+\.\S+)$/.test(a.value)},e=function(a){return/^-?(([\d]{1,3}(,{1}[\d]{3})*)|[\d]+)$/.test(a.value)},f=function(a){return/^((-?[\d]{1,3}(,[\d]{3})*(\.[\d]{2})*)|-?[\d]+(\.[\d]{2})?)$/.test(a.value)},g=function(a){var b=a.getAttribute("data-decimal-max");null===b&&(b=2);var c="^-?((([\\d]{1,3}(,[\\d]{3})*)+(\\.[\\d]{1,decimalPlaces})?)|[\\d]+(\\.[\\d]{1,decimalPlaces})?)$",d=new RegExp(c.replace(/decimalPlaces/g,b));return d.test(a.value)},h=function(a){return/^(\d{4})$/.test(a.value)},i=function(a){var b=$(a),c=null!==b.datepicker("getDate"),d=a.hasAttribute("data-no-past-date");if(d&&c){var e=new Date,f=new Date(e.getFullYear(),e.getMonth(),e.getDate());c=b.datepicker("getDate").getTime()>=f.getTime()}return c},j=function(a,b,c){this.ruleType=a,this.ruleClass=b,this.validate=c},k=[new j("alpha","alpha-only",a),new j("alpha","alpha-zip",b),new j("alpha","alpha-numeric",c),new j("alpha","alpha-email",d),new j("numeric","numeric-whole",e),new j("numeric","numeric-monetary",f),new j("numeric","numeric-decimal",g),new j("numeric","numeric-full-year",h),new j("numeric","numeric-jquery-date",i)],l=function(a,b,c){if("alpha"!==a&&"numeric"!==a)throw new Error('The rule type for a new validation rule must be either "alpha" or "numeric"');if("string"!=typeof b)throw new Error("The rule class for a new validation rule is missing or is not of type string");if("function"!=typeof c)throw new Error("The validation function for a new validation rule is missing or is not of type function");var d=new j(a,b,c);k.push(d)},m=function(a){for(var b=Array.isArray(a),c=null,d=0;d<k.length;d++){var e=b?a.indexOf(k[d].ruleClass)===-1:k[d].ruleClass!==a;if(!e){c=k[d];break}}return c},n=function(a,b,c){var d=m(b);null===d?l(a,b,c):(d.ruleClass=b,d.validate=c)};return{getRuleByRuleClass:m,addOrUpdateValidationRule:n}}(),validation=function(){var a=function(a){var d=$(a),e=!0,f=d.prop("disabled")===!0;if(f)return e;var g=d.is("input, textarea"),h=d.is("select");return g&&(e=b(a)),h&&(e=c(a)),e},b=function(a){var b=$(a),c=!0,f=b.hasClass("alpha"),g=b.hasClass("numeric"),h=b.hasClass("optional"),i=b.val(),j=""===$.trim(i)||void 0===i,k=j&&h;return k?c:(f&&(c=d(a)),g&&(c=e(a)),c)},c=function(a){var b=$(a),c=b.val(),d=b.hasClass("optional"),e=""===$.trim(c)||void 0===c,f=d&&e||!e;return f},d=function(a){var b=!0,c=a.getAttribute("pattern"),d=a.getAttribute("class"),e=null!==c;if(e){var f=new RegExp(c,"u");return f.test(a.value)}var g=null===d;if(g)return b;var h=d.split(" "),i=rules.getRuleByRuleClass(h);return null===i?b:b=i.validate(a)},e=function(a){var b=!0,c=a.getAttribute("pattern"),d=null!==c;if(d){var e=new RegExp(c,"u");b=e.test(a.value)}else{var f=a.getAttribute("class"),g=f?f.split(" "):"",h=rules.getRuleByRuleClass(g);null!==h&&(b=h.validate(a))}if(b){var i=Number(a.value.replace(",","")),j=$.trim(a.getAttribute("min")),k=$.trim(a.getAttribute("max")),l=""===j||null===j?null:Number(j),m=""===k||null===k?null:Number(k),n=null!==l,o=null!==m;n&&o?b=i>=l||i<=m:n?b=i>=l:o&&(b=i<=m)}return b};return{validateElement:a}}();if("undefined"==typeof jQuery||"undefined"==typeof $)throw new Error("ritsu.js requires jQuery or a jQuery-compatible API");var ritsu=function(){var a=!1,b=!0,c=!1,d=function(d){var e="object"!=typeof d;if(e)throw new Error("Invalid options to initialize ritsu.js");a=void 0!==d.useBootstrap3Stlying&&d.useBootstrap3Stlying,b=void 0===d.autoMarkInvalidFields||d.autoMarkInvalidFields,c=void 0!==d.autoShowErrorMessages&&d.autoShowErrorMessages;var f=d.validationRules;return void 0!==f&&k(f),this},e=function(a){var b=void 0===a;b&&(a=$("input, textarea, select"));var c=!a.is("input, textarea, select");return c&&(a=a.find("input, textarea, select")),a.each(function(){var a=$(this),b=a.is('input[type="checkbox"]'),c=a.is('input[type="radio"]'),d=a.is('input[type="file"]');if(b||c)a.data("initialValue",a.is(":checked"));else if(d){var e=void 0!==a.data("simple-file-hash");if(e)return a.data("initialValue",a.data("simple-file-hash")),!0;var f=this.files.length>0,g=f?this.files[0].name+this.files[0].size+this.files[0].lastModified:"";a.data("initialValue",g)}else a.data("initialValue",a.val())}),this},f=function(a){var b=!1,c=void 0===a;c&&(a=$("input, textarea, select"));var d=!a.is("input, textarea, select");return d&&(a=a.find("input, textarea, select")),a.each(function(){var a=$(this),c=void 0===a.data("initialValue");if(c)return!0;var d=a.is('input[type="checkbox"]'),e=a.is('input[type="radio"]'),f=a.is('input[type="file"]'),g=!1;if(d||e)g=a.data("initialValue")!=a.is(":checked");else if(f){var h=this.files.length>0;g=a.data("initialValue")!=(h?this.files[0].name+this.files[0].size+this.files[0].lastModified:a.data("simple-file-hash"))}else g=a.data("initialValue")!=a.val();return g?(b=!0,!1):void 0}),b},g=function(a){var d=void 0===a;d&&(a=$("input, textarea, select"));var e=!a.is("input, textarea, select");e&&(a=a.find("input, textarea, select"));var f=!0;return a.each(function(){var a=$(this),b=!validation.validateElement(this);b?(f=!1,a.data("invalid",!0)):(a.data("invalid",!1),l(a))}),b&&h(a),c&&i(a),f},h=function(b){var c=void 0===b;c&&(b=$("input, textarea, select"));var d=!b.is("input, textarea, select");return d&&(b=b.find("input, textarea, select")),b.each(function(){var b=$(this),c=a?b.closest(".form-group"):b,d=b.data("invalid");d?c.addClass("has-error"):c.removeClass("has-error")}),this},i=function(b){var c=void 0===b;c&&(b=$("input, textarea, select"));var d=!b.is("input, textarea, select");return d&&(b=b.find("input, textarea, select")),b.each(function(){var b=$(this);l(b);var c=!b.data("invalid");if(c)return!0;var d=m(b);if(a){var e=b.closest(".form-group");e.append('<span class="help-block">'+d+"</span>")}else{var f=b.attr("id"),g=0===b.closest(".error-label-container").length?b.parent():b.closest(".error-label-container");g.append('<label class="error-label"'+(f?' for="'+f+'"':"")+">"+d+"</label>")}}),this},j=function(a,b,c){var d=Array.isArray(a);d?k(a):rules.addOrUpdateValidationRule(c,a,b)},k=function(a){a.forEach(function(a){rules.addOrUpdateValidationRule(a.ruleType,a.ruleClass,a.validationFunction)})},l=function(b){if(b.closest("td").find(".error-label").remove(),a)return void b.closest(".form-group").find(".help-block").remove();var c=b.closest(".error-label-container");0===c.length&&(c=b.parent()),c.find(".error-label, .warning-label").remove()},m=function(a){var b=a.hasClass("alpha");if(b){var c=a.hasClass("alpha-all");if(c)return null;var d=a.hasClass("alpha-only");if(d)return"Please enter only letters";var e=a.hasClass("alpha-zip");if(e)return"Please enter a valid zip code";var f=a.hasClass("alpha-jquery-date");if(f)return"Please select a date from the datepicker";var g=a.hasClass("alpha-numeric");if(g)return"Please enter only alphanumeric characters"}var h=a.hasClass("numeric");if(h){var i,j=a.hasClass("numeric-whole");j&&(i="Please enter a whole number");var k=a.hasClass("numeric-monetary");k&&(i="Please enter a monetary value");var l=a.hasClass("numeric-decimal");l&&(i="Please enter a number");var m=a.hasClass("numeric-full-year");m&&(i="Please enter a 4 digit year");var n=void 0!==a.attr("min"),o=void 0!==a.attr("max"),p=void 0!==a.data("decimal-max");return p&&(i+=" with "+a.data("decimal-max")+" decimal places max"),n&&o?i=i+" from "+a.attr("min")+" to "+a.attr("max"):n?i=i+" greater or equal to "+a.attr("min"):o&&(i=i+" lesser or equal to "+a.attr("max")),i+="."}return"Invalid Value"};return{initialize:d,storeInitialFormValues:e,isFormDirty:f,validate:g,markInvalidFields:h,showErrorMessages:i,addValidationRule:j}}();
