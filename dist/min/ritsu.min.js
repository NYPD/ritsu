/* ritsu.js v0.2.0 
 * Created 2016-10-05
 * Licensed under the MIT license
 * Source code can be found here: https://github.com/NYPD/ritsu 
 */

var rules=function(a){var b=function(a){for(var b=Array.isArray(a),c=null,d=0;d<m.length;d++){var e=b?a.indexOf(m[d].ruleClass)===-1:m[d].ruleClass!==ruleClass;if(!e){c=m[d];break}}return c},c=function(a){return/^([A-Za-z\s\.\-])+$/.test(a.value)},d=function(a){return/(^\d{5}([\s-]?\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Z]{1}\d{1}$)/.test(a.value)},e=function(a){return/^([a-zA-Z0-9]+)$/.test(a.value)},f=function(a){return/^(\S+@\S+\.\S+)$/.test(a.value)},g=function(a){return/^-?(([\d]{1,3}(,{1}[\d]{3})*)|[\d]+)$/.test(a.value)},h=function(a){return/^((-?[\d]{1,3}(,[\d]{3})*(\.[\d]{2})*)|-?[\d]+(\.[\d]{2})?)$/.test(a.value)},i=function(a){var b=a.getAttribute("data-decimal-max");null===b&&(b=2);var c="^-?((([\\d]{1,3}(,[\\d]{3})*)+(\\.[\\d]{1,decimalPlaces})?)|[\\d]+(\\.[\\d]{1,decimalPlaces})?)$",d=new RegExp(c.replace(/decimalPlaces/g,b));return d.test(a.value)},j=function(a){return/^(\d{4})$/.test(a.value)},k=function(a){var b=$(a),c=null!==b.datepicker("getDate"),d=a.hasAttribute("data-no-past-date");if(d&&c){var e=new Date,f=new Date(e.getFullYear(),e.getMonth(),e.getDate());validNumeric=b.datepicker("getDate").getTime()>=f.getTime()}return c},l=function(a,b,c){this.primaryClass=a,this.ruleClass=b,this.validate=c},m=[new l("alpha","alpha-only",c),new l("alpha","alpha-zip",d),new l("alpha","alpha-numeric",e),new l("alpha","alpha-email",f),new l("numeric","numeric-whole",g),new l("numeric","numeric-monetary",h),new l("numeric","numeric-decimal",i),new l("numeric","numeric-full-year",j),new l("numeric","numeric-jquery-date",k)];return{getRuleByRuleClass:b}}(),validation=function(){var a=function(a){var d=$(a),e=!0,f=d.prop("disabled")===!0;if(f)return e;var g=d.is("input, textarea"),h=d.is("select");return g&&(e=b(a)),h&&(e=c(a)),e},b=function(a){var b=$(a),c=!0,f=b.hasClass("alpha"),g=b.hasClass("numeric"),h=b.hasClass("optional"),i=b.val(),j=""===$.trim(i)||void 0===i,k=j&&h;return k?c:(f&&(c=d(a)),g&&(c=e(a)),c)},c=function(a){var b=$(a),c=b.val(),d=b.hasClass("optional"),e=""===$.trim(c)||void 0===c,f=d&&e||!e;return f},d=function(a){var b=!0,c=a.getAttribute("class"),d=null===c;if(d)return b;var e=c.split(" "),f=rules.getRuleByRuleClass(e);return null===f?b:b=f.validate(a)},e=function(a){var b=!0,c=a.getAttribute("class"),d=null===c;if(d)return b;var e=c.split(" "),f=rules.getRuleByRuleClass(e);if(null===f)return b;if(b=f.validate(a)){var g=(Number(a.value.replace(",","")),$.trim(a.getAttribute("min"))),h=$.trim(a.getAttribute("max")),i=""===g||null===g?null:Number(g),j=""===h||null===h?null:Number(h),k=null!==i,l=null!==j;k&&l?b=fieldValue>=i||fieldValue<=j:k?b=fieldValue>=i:l&&(b=fieldValue<=j)}return b};return{validateElement:a}}();if("undefined"==typeof jQuery||"undefined"==typeof $)throw new Error("ritsu.js requires jQuery or a jQuery-compatible API");var ritsu=function(){var a=!1,b=!0,c=!1,d=function(d){var e="object"!=typeof d;if(e)throw"Invalid options to initialize ritsu.js";return a=void 0!==d.useBootstrap3Stlying&&d.useBootstrap3Stlying,b=void 0===d.autoMarkInvalidFields||d.autoMarkInvalidFields,c=void 0!==d.autoShowErrorMessages&&d.autoShowErrorMessages,this},e=function(a){var b=void 0===a;b&&(a=$("input, textarea, select"));var c=!a.is("input, textarea, select");return c&&(a=a.find("input, textarea, select")),a.each(function(){var a=$(this),b=a.is('input[type="checkbox"]'),c=a.is('input[type="radio"]'),d=a.is('input[type="file"]');if(b||c)a.data("initialValue",a.is(":checked"));else if(d){var e=void 0!==a.data("simple-file-hash");if(e)return a.data("initialValue",a.data("simple-file-hash")),!0;var f=this.files.length>0,g=f?this.files[0].name+this.files[0].size+this.files[0].lastModified:"";a.data("initialValue",g)}else a.data("initialValue",a.val())}),this},f=function(a){var b=!1,c=void 0===a;c&&(a=$("input, textarea, select"));var d=!a.is("input, textarea, select");return d&&(a=a.find("input, textarea, select")),a.each(function(){var a=$(this),c=void 0===a.data("initialValue");if(c)return!0;var d=a.is('input[type="checkbox"]'),e=a.is('input[type="radio"]'),f=a.is('input[type="file"]'),g=!1;if(d||e)g=a.data("initialValue")!=a.is(":checked");else if(f){var h=this.files.length>0;g=a.data("initialValue")!=(h?this.files[0].name+this.files[0].size+this.files[0].lastModified:a.data("simple-file-hash"))}else g=a.data("initialValue")!=a.val();return g?(b=!0,!1):void 0}),b},g=function(a){var d=void 0===a;d&&(a=$("input, textarea, select"));var e=!a.is("input, textarea, select");e&&(a=a.find("input, textarea, select"));var f=!0;return a.each(function(){var a=$(this),b=!validation.validateElement(this);b?(f=!1,a.data("invalid",!0)):(a.data("invalid",!1),j(a))}),b&&h(a),c&&i(a),f},h=function(b){var c=void 0===b;c&&(b=$("input, textarea, select"));var d=!b.is("input, textarea, select");return d&&(b=b.find("input, textarea, select")),b.each(function(){var b=$(this),c=a?b.closest(".form-group"):b,d=b.data("invalid");d?c.addClass("has-error"):c.removeClass("has-error")}),this},i=function(b){var c=void 0===b;c&&(b=$("input, textarea, select"));var d=!b.is("input, textarea, select");return d&&(b=b.find("input, textarea, select")),b.each(function(){var b=$(this);j(b);var c=!b.data("invalid");if(c)return!0;var d=k(b);if(a){var e=b.closest(".form-group");e.append('<span class="help-block">'+d+"</span>")}else{var f=b.attr("id"),g=0===b.closest(".error-label-container").length?b.parent():b.closest(".error-label-container");g.append('<label class="error-label"'+(f?' for="'+f+'"':"")+">"+d+"</label>")}}),this},j=function(b){if(b.closest("td").find(".error-label").remove(),a)return void b.closest(".form-group").find(".help-block").remove();var c=b.closest(".error-label-container");0===c.length&&(c=b.parent()),c.find(".error-label, .warning-label").remove()},k=function(a){var b=a.hasClass("alpha");if(b){var c=a.hasClass("alpha-all");if(c)return null;var d=a.hasClass("alpha-only");if(d)return"Please enter only letters";var e=a.hasClass("alpha-zip");if(e)return"Please enter a valid zip code";var f=a.hasClass("alpha-jquery-date");if(f)return"Please select a date from the datepicker";var g=a.hasClass("alpha-numeric");if(g)return"Please enter only alphanumeric characters"}var h=a.hasClass("numeric");if(h){var i,j=a.hasClass("numeric-whole");j&&(i="Please enter a whole number");var k=a.hasClass("numeric-monetary");k&&(i="Please enter a monetary value");var l=a.hasClass("numeric-decimal");l&&(i="Please enter a number");var m=a.hasClass("numeric-full-year");m&&(i="Please enter a 4 digit year");var n=void 0!==a.attr("min"),o=void 0!==a.attr("max"),p=void 0!==a.data("decimal-max");return p&&(i+=" with "+a.data("decimal-max")+" decimal places max"),n&&o?i=i+" from "+a.attr("min")+" to "+a.attr("max"):n?i=i+" greater or equal to "+a.attr("min"):o&&(i=i+" lesser or equal to "+a.attr("max")),i+="."}return"Invalid Value"};return{initialize:d,storeInitialFormValues:e,isFormDirty:f,validate:g,markInvalidFields:h,showErrorMessages:i}}();
