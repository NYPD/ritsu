/* ritsu.js v1.1.2 
 * Created 2017-03-05
 * Licensed under the MIT license
 * Source code can be found here: https://github.com/NYPD/ritsu 
 */

var ritsu = (function() {
var rules=function(){var a=[],b=function(b){for(var c=Array.isArray(b),d=null,e=0;e<a.length;e++){var f=c?b.indexOf(a[e].ruleClass)===-1:a[e].ruleClass!==b;if(!f){d=a[e];break}}return d},c=function(a,b,c,d){var f=Array.isArray(a),g="object"==typeof a&&!f;f||g?(g&&(a=[a]),a.forEach(function(a){e(a.ruleType,a.ruleClass,a.validationFunction,a.errorMessage)})):e(a,b,c,d)},d=function(a,b,c,d){this.ruleType=a,this.ruleClass=b,this.validate=c,this.getErrorMessage=d},e=function(c,e,f,g){if("alpha"!==c&&"numeric"!==c)throw new Error('The rule type for a new validation rule must be either "alpha" or "numeric"');if("string"!=typeof e)throw new Error("The rule class for a new validation rule is missing or is not of type string");if("function"!=typeof f)throw new Error("The validation function for a new validation rule is missing or is not of type function");void 0===g&&(g=new Function("",'return "Invalid value";')),"string"==typeof g&&(g=new Function("",'return "'+g+'";'));var h=b(e);if(null!==h){var i=a.indexOf(h);a.splice(i,1)}a.push(new d(c,e,f,g))},f=function(a){var b=a.value,c=a.hasAttribute("data-no-space"),d="^([A-Za-z@.-])+$",e=new RegExp(d.replace(/@/g,c?"":"\\s"));return e.test(b)},g=function(a){return/(^\d{5}([\s-]?\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Z]{1}\d{1}$)/.test(a.value)},h=function(a){var b=a.value,c=a.hasAttribute("data-no-space"),d="^([a-zA-Z0-9@]+)$",e=new RegExp(d.replace(/@/g,c?"":"\\s"));return e.test(b)},i=function(a){return/^(\S+@\S+\.\S+)$/.test(a.value)},j=function(a){var b=a.value,c=a.hasAttribute("data-no-thousands-separator"),d=/^-?(([\d]{1,3}(,{1}[\d]{3})*)|[\d]+)$/.test(b);return c&&(d=d&&b.indexOf(",")===-1),d},k=function(a){var b="Enter a whole number",c=a.hasAttribute("min"),d=a.hasAttribute("max");return c&&d?b=b+" from "+a.getAttribute("min")+" to "+a.getAttribute("max"):c?b=b+" greater or equal to "+a.getAttribute("min"):d&&(b=b+" lesser or equal to "+a.getAttribute("max")),b},l=function(a){var b=a.value,c=a.hasAttribute("data-no-thousands-separator"),d=a.getAttribute("data-decimal-max");null===d&&(d=2);var e="^-?((([\\d]{1,3}(,[\\d]{3})*)+(\\.[\\d]{1,decimalPlaces})?)|[\\d]+(\\.[\\d]{1,decimalPlaces})?)$",f=new RegExp(e.replace(/decimalPlaces/g,d)),g=f.test(b);return c&&(g=g&&b.indexOf(",")===-1),g},m=function(a){var b="Please enter a number",c=a.hasAttribute("min"),d=a.hasAttribute("max"),e=a.hasAttribute("data-decimal-max")?a.getAttribute("data-decimal-max"):2;return b+=" with "+e+" decimal places max",c&&d?b=b+" and from "+a.getAttribute("min")+" to "+a.getAttribute("max"):c?b=b+" and greater or equal to "+a.getAttribute("min"):d&&(b=b+" and lesser or equal to "+a.getAttribute("max")),b},n=function(a){return/^(\d{4})$/.test(a.value)},o=function(a){var b="Please enter a 4 digit year",c=a.hasAttribute("min"),d=a.hasAttribute("max");return c&&d?b=b+" from "+a.getAttribute("min")+" to "+a.getAttribute("max"):c?b=b+" greater or equal to "+a.getAttribute("min"):d&&(b=b+" lesser or equal to "+a.getAttribute("max")),b},p=function(a){var b=$(a),c=null!==b.datepicker("getDate");return c};return e("alpha","alpha-only",f,"Only letters, spaces, hypens, and periods are allowed"),e("alpha","alpha-zip",g,"Enter a valid zip code"),e("alpha","alpha-numeric",h,"Enter only alphanumeric characters"),e("alpha","alpha-email",i,"Make sure the email is correct"),e("numeric","numeric-whole",j,k),e("numeric","numeric-decimal",l,m),e("numeric","numeric-full-year",n,o),e("numeric","numeric-jquery-date",p,"Please select a date from the date picker"),{getRuleByRuleClass:b,addValidationRule:c}},validation=function(a){var b=function(a){var b=!0,e=a.disabled===!0;if(e)return b;var f=["INPUT","TEXTAREA"].indexOf(a.nodeName)>-1,g="SELECT"===a.nodeName;return f&&(b=c(a)),g&&(b=d(a)),b},c=function(a){var b=!0,c="hidden"===a.type;if(c)return b;var d=a.classList.contains("alpha"),h=a.classList.contains("numeric"),i="file"===a.type,j=a.hasAttribute("required"),k=a.value,l=void 0===k||""===k.trim(),m=l&&!j&&!i;return m?b:(d&&(b=f(a)),h&&(b=g(a)),i&&(b=e(a)),d||h||i||!j||(b=!l),b)},d=function(a){var b=a.selectedIndex===-1?void 0:a.options[a.selectedIndex].value,c=a.hasAttribute("required"),d=void 0===b||""===b.trim(),e=d&&!c||!d;return e},e=function(a){var b=!0,c=!a.hasAttribute("required");if(c)return b;var d=a.getAttribute("data-simple-file-hash"),e=!(null!==d&&""!==d.trim()),f=0===a.files.length;return f&&e&&(b=!1),b},f=function(b){var c=!0,d=b.getAttribute("pattern"),e=b.getAttribute("class"),f=null!==d;if(f){var g=new RegExp(d,"u");return g.test(b.value)}var h=null===e||""===e;if(h)return c;var i=e.split(" "),j=a.getRuleByRuleClass(i);return null===j?c:c=j.validate(b)},g=function(b){var c=!0,d=b.getAttribute("pattern"),e=null!==d;if(e){var f=new RegExp(d,"u");c=f.test(b.value)}else{var g=b.getAttribute("class"),h=g?g.split(" "):"",i=a.getRuleByRuleClass(h);null!==i&&(c=i.validate(b))}if(c){var j=Number(b.value.replace(",",""));if(isNaN(j))return c;var k=b.getAttribute("min"),l=b.getAttribute("max"),m=""===k||null===k?null:Number(k),n=""===l||null===l?null:Number(l),o=null!==m,p=null!==n;o&&p?c=j>=m&&j<=n:o?c=j>=m:p&&(c=j<=n)}return c};return{validateElement:b}},core=function(a,b){var c="undefined"!=typeof jQuery,d=!1,e=!0,f=!1,g=function(b){var c="object"!=typeof b;if(c)throw new Error("Invalid options to initialize ritsu.js");d=void 0!==b.useBootstrap3Stlying&&b.useBootstrap3Stlying,e=void 0===b.autoMarkInvalidFields||b.autoMarkInvalidFields,f=void 0!==b.autoShowErrorMessages&&b.autoShowErrorMessages;var g=b.validationRules;return void 0!==g&&a.addValidationRule(g),this},h=function(a){var b=m(a);return b.forEach(function(a){var b="checkbox"===a.type,c="radio"===a.type,d="file"===a.type;if(b||c)a.setAttribute("data-initial-value",a.checked);else if(d){var e=void 0!==a.getAttribute("data-simple-file-hash");if(e)return a.setAttribute("data-initial-value",a.getAttribute("data-simple-file-hash")),!0;var f=a.files.length>0,g=f?a.files[0].name+a.files[0].size:void 0;a.setAttribute("data-initial-value",g)}else a.setAttribute("data-initial-value",a.value)}),this},i=function(a){var b=!1,c=m(a);return c.forEach(function(a){var c=void 0===a.getAttribute("data-initial-value");if(c)return!0;var d="checkbox"===a.type,e="radio"===a.type,f="file"===a.type,g=!1,h=a.getAttribute("data-initial-value");if(d||e)g=h!=""+a.checked;else if(f){var i=a.files.length>0;g=h!==(i?a.files[0].name+a.files[0].size:a.getAttribute("data-simple-file-hash"))}else g=h!==a.value;return g?(b=!0,!1):void 0}),b},j=function(a){var c=m(a),d=!0;return c.forEach(function(a){var c=!b.validateElement(a);c?(d=!1,a.setAttribute("data-invalid",!0)):(a.setAttribute("data-invalid",!1),o(a))}),e&&k(a),f&&l(a),d},k=function(a){var b=m(a);return b.forEach(function(a){var b=d?n(a,"form-group"):a;null===b&&(b=a);var c="true"===a.getAttribute("data-invalid");c?b.classList.add("has-error"):b.classList.remove("has-error")}),this},l=function(a){var b=m(a);return b.forEach(function(a){o(a);var b="true"!==a.getAttribute("data-invalid");if(b)return!0;var c=p(a);if(d){var e=n(a,"form-group"),f=e.querySelector(".help-block"),g=null!==f,h=document.createElement("em");h.innerHTML=c;var i=document.createElement("b");if(g){var j=document.createElement("br");j.className="ritsu-error",i.className="ritsu-error",i.appendChild(h),i.appendChild(j),f.insertBefore(i,f.firstChild)}else{i.appendChild(h);var k=document.createElement("span");k.className="help-block ritsu-error",k.appendChild(i),e.appendChild(k)}}else{var l=a.getAttribute("id"),m=document.createElement("label");m.className="error-label",m.htmlFor=l?l:"",m.innerHTML=c;var q=null===n(a,"form-group")?a.parentElement:n(a,"form-group");q.appendChild(m)}}),this},m=function(a){var b=!!c&&a instanceof jQuery;a=b?a.get():a;var d=void 0===a;d&&(a=Array.prototype.slice.call(document.querySelectorAll("input, textarea, select")));var e=!Array.isArray(a);e&&(a=[a]);var f=0===a.length;if(f)return[];var g=a[0],h=["INPUT","TEXTAREA","SELECT"].indexOf(g.nodeName)===-1;return h&&(a=Array.prototype.slice.call(g.querySelectorAll("input, textarea, select"))),a},n=function(a,b){for(;a;){var c=a.parentElement,d=null!==c&&c.classList.contains(b);if(d)return c;a=c}return null},o=function(a){var b=n(a,d?"form-group":"error-label-container");null!==b&&Array.prototype.slice.call(b.querySelectorAll(d?".ritsu-error":".error-label, .warning-label")).forEach(function(a){a.parentElement.removeChild(a)})},p=function(b){var c="SELECT"===b.nodeName;if(c)return"Please select an option";var d=b.hasAttribute("data-error-message");if(d)return b.getAttribute("data-error-message");var e="Invalid Value",f=b.getAttribute("class"),g=null===f||""===f;if(g)return e;var h=f.split(" "),i=a.getRuleByRuleClass(h);return null!==i&&(e=i.getErrorMessage(b)),e};return{rules:a,initialize:g,storeInitialFormValues:h,isFormDirty:i,validate:j,markInvalidFields:k,showErrorMessages:l}};
return core(rules(), validation(rules()));
})();
